<launch>
    <!-- 参数配置 -->
    <arg name="uav_id" default="1"/>
    <arg name="uav_name" default="uav"/>
    <arg name="flight_height" default="0.6"/>
    <arg name="forward_vel" default="0.5"/>
    <arg name="rotate_speed" default="1.3"/>
    <arg name="obstacle_threshold" default="1000"/>
    <arg name="ratio_threshold" default="0.3"/>
    <arg name="target_x" default="0.0"/>
    <arg name="target_y" default="0.0"/>
    <arg name="target_topic_name" default="/goal_1"/>
    <arg name="clear_obstacle_duration" default="1.4"/>
    <arg name="roll_time" default="0.1"/>

    <!-- 是否自动起飞，默认不起飞，直接运行避障程序 -->
    <arg name="AUTO_FLIGHT" default="false"/>
    
    <arg name="odom_sub_topic" default="/mavros/local_position/odom"/>
    <arg name="depth_image_sub_topic" default="/camera/depth/image_rect_raw"/>

    <!-- 启动简易避障节点 -->
    <node pkg="woosen" 
          type="Obstacle_Avoidance" 
          name="Obstacle_Avoidance_$(arg uav_name)$(arg uav_id)" 
          output="screen"
          respawn="false">

        <param name="AUTO_FLIGHT" value="$(arg AUTO_FLIGHT)"/>
        <param name="odom_sub_topic" value="$(arg odom_sub_topic)"/>
        <param name="depth_image_sub_topic" value="$(arg depth_image_sub_topic)"/>
        
        <!-- 无人机基本参数 -->
        <param name="uav_id" value="$(arg uav_id)"/>
        <param name="uav_name" value="$(arg uav_name)"/>
        
        <!-- 飞行参数 -->
        <param name="flight_height" value="$(arg flight_height)"/>
        <param name="forward_vel" value="$(arg forward_vel)"/>
        <param name="rotate_speed" value="$(arg rotate_speed)"/>
        <param name="obstacle_threshold" value="$(arg obstacle_threshold)"/>
        <param name="ratio_threshold" value="$(arg ratio_threshold)"/>
        <param name="roll_time" value="$(arg roll_time)"/>
        
        <!-- 初始目标点 -->
        <param name="target_x" value="$(arg target_x)"/>
        <param name="target_y" value="$(arg target_y)"/>
        
        <!-- 动态目标更新话题 -->
        <param name="target_topic_name" value="$(arg target_topic_name)"/>
        
        <param name="clear_obstacle_duration" value="$(arg clear_obstacle_duration)"/>
    </node>
</launch>